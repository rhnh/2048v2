(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();const c=e=>e,u=e=>({map:t=>u(t(e)),fold:t=>t(e)}),le=()=>{Number(globalThis.globalScore)>Number(localStorage.getItem("best-score"))&&localStorage.setItem("best-score",`${globalThis.globalScore}`),window.location.reload()},M=()=>window.innerWidth>0?window.innerWidth:screen.width,v=e=>e.map(t=>t.map(n=>`${n.value}+${n.pValue}`)).toString(),Ce=e=>{let t=2;for(;t*t<e;)t++;return t},K=e=>{const t=e.split(","),n=[],r=t.map(o=>{const l=o.indexOf("+"),s=o.slice(0,l),a=o.slice(l+1);return{value:Number(s),pValue:Number(a),id:0}});for(;r.length;)n.push(r.splice(0,Ce(t.length)));return n},O=(e,t)=>{let n=150;return e===4&&(n=Se(t)),e===6&&(n=$e(t)),e===8&&(n=Be(t)),n};function Se(e){return e<=x?78:e<=w?88:e<=C?92:e<=S?94.5:e<=U?96:e<=X?101.5:e<=Z?105:(e<=_,120)}function $e(e){return e<=x?52:e<=w?60:e<=C?61:e<=S?62.5:e<=U?63.5:e<=X?67:e<=Z?70:e<=_?90:76}function Be(e){return e<=x?38.5:e<=w?43:e<=C?46:e<=S?46.5:e<=U?47.5:e<=X?50:e<=Z?52:(e<=_,70)}const x=320,w=360,C=375,S=384,U=390,X=414,Z=428,_=800,Ae=({digitLength:e,actualScreenWidth:t})=>t<=x?e<3?20:18:t<=w?e<3?30:20:t<=C||t<=S?e<3?35:22:40,Me=({digitLength:e,actualScreenWidth:t})=>t<=x||t<=w?e<3?24:20:t<=C?e<3?30:20:t<=S?e<3?35:22:24,Ne=({digitLength:e,actualScreenWidth:t})=>t<=x?e<3?24:20:t<=w?e<3?22:20:t<=C?e<3?25:22:t<=S?e<3?28:20:24;//!!Todo
function Ie({boardSize:e,actualScreenWidth:t,digitLength:n}){let r=40;return e===4&&(r=Ae({actualScreenWidth:t,digitLength:n})),e===6&&(r=Me({digitLength:n,actualScreenWidth:t})),e===8&&(r=Ne({digitLength:n,actualScreenWidth:t})),`${r}px`}const ne=e=>{const t=e.filter(r=>r.value!==0),n=e.filter(r=>r.value===0);return[...t,...n]},T=e=>Array.from(e),A=e=>{const t=T(e).map(n=>T(n));return t[0].map((n,r)=>t.map(o=>o[r]))},ke=(e,t)=>{if(e.length!==t.length||!Array.isArray(e)||!Array.isArray(t))return!1;for(let n=0;n<e.length;n++)for(let r=0;r<e.length;r++)if(e[n][r].pValue!==t[n][r].pValue||e[n][r].value!==t[n][r].value||e[n][r].id!==t[n][r].id)return!1;return!0},Ve=e=>[...Array.from(e)].map((t,n)=>{const r=e[n+1];return r===void 0?n:t.value===r.value?-1:n}).map(t=>t==-1).filter(t=>t===!0).length>0,Oe=e=>{const t=ne(T(e));for(let n=0;n<e.length;n++)t[n].pValue=0;for(let n=1;n<e.length;n++){let r=n-1;if(t[n].value===t[r].value){globalThis.globalScore+=t[n].value*2;let o={...t[n],pValue:0,value:0},l={...t[r],value:2*t[r].value,pValue:t[r].value};t[r]=l,t[n]=o}}return ne(T(t))},Pe=e=>e.flat().filter(t=>t.value===0).length<=0;function se({cells:e,isInitial:t=!1,base:n}){const r=T(e).map(a=>T(a));if(Pe(r))return r;const o=ze(r),l=o[0],s=o[1];return r[l][s].pValue=-1,t?r[l][s].value=n:r[l][s].value=Math.random()<.9?n:2*n,r}const J=({cells:e,isInitial:t,base:n,total:r})=>{let o=0,l=[...e];for(;o<r;)l=se({cells:l,isInitial:t,base:n}),o++;return l},ze=e=>{const t=e.map((r,o)=>r.map((l,s)=>l.value===0?[o,s]:[])).flat().filter(r=>r.length>0),n=Math.floor(Math.random()*t.length);return t[n]};function P(e){return Array.from(Array(e).keys()).map(()=>Array.from(Array(e).keys())).map(t=>t.map(()=>({value:0,id:0,pValue:0})))}const j=e=>He(e)&&!De(e)&&!ce(e);function Ee(e,t){return t-e}const Le=e=>e.flat().map(t=>t.value).sort(Ee)[0],Re=e=>e.slice().reverse(),re=e=>e.map(Re),ie=e=>e.map(Oe),Q=e=>u(e).map(ie).fold(c),W=e=>u(e).map(re).map(ie).map(re).fold(c),ae=e=>u(e).map(A).map(Q).map(A).fold(c),ue=e=>u(e).map(A).map(W).map(A).fold(c),ce=e=>Array.from(e).map(t=>Ve(t)).filter(t=>t===!0).length!==0,De=e=>ce(A(Array.from(e))),He=e=>{var t;return((t=e.flat().find(n=>n.value===0))==null?void 0:t.value)!==0},k=(e,t)=>e.indexOf(t)!==-1,Fe=e=>{addEventListener("keydown",t=>{if(k(["ArrowDown","s","j"],t.key))return t.preventDefault(),e(ue);if(k(["ArrowUp","w","k"],t.key))return t.preventDefault(),e(ae);if(k(["ArrowLeft","a","h"],t.key))return t.preventDefault(),e(Q);if(k(["ArrowRight","d","l"],t.key))return t.preventDefault(),e(W);t.key==="r"&&le()})},je=(e,t)=>{const n={x1:0,y1:0,x2:0,y2:0};let r;e.addEventListener("touchstart",o=>{o.preventDefault(),n.x1=o.touches[0].clientX,n.y1=o.touches[0].clientY},{passive:!1}),e.addEventListener("touchmove",o=>{o.preventDefault(),n.x2=o.changedTouches[0].clientX,n.y2=o.changedTouches[0].clientY},{passive:!1}),e.addEventListener("touchend",o=>{o.preventDefault();const l=n.x2-n.x1,s=n.y2-n.y1,a=Math.abs(s),g=Math.abs(l);Math.max(a,g)>50&&(r=g>a?l>0?"right":"left":s<0?"up":"down"),r==="down"&&t(ue),r==="up"&&t(ae),r==="left"&&t(Q),r==="right"&&t(W)})},y=(e,t,n)=>u(i("button")(n)).map(r=>(r.innerHTML=e,r)).map(r=>(r.onclick=t,r)).fold(c),i=e=>t=>u(document.createElement(e)).map(n=>(n.className+=t,n)).fold(c),N=({board:e,cells:t,state:n,visibility:r,onClose:o,className:l,colors:s,base:a,showOnClose:g=!0,target:L})=>R=>u(i("article")("modal")).map(p=>(p.className+=` ${l??""}`,p.style.zIndex="100000",p.style.position="absolute",p.style.width="100%",p.style.visibility=r,p)).map(p=>{if(!g)return p;const I=i("button")("modal-close");return I.innerText="x",p.appendChild(I),o&&(I.onclick=o),I.onclick=()=>{e.removeChild(p),m(e),Number(globalThis.globalScore)>Number(localStorage.getItem("best-score"))&&localStorage.setItem("best-score",`${globalThis.globalScore}`),z({cells:t,board:e,state:n,colors:s,base:a,target:L})},p}).map(p=>(p.append(...R),p)).map(p=>(m(e),e.appendChild(p),p)).fold(c),pe=(e,t,n)=>u(i("section")("score")).map(r=>{const o=i("p")("score-label");o.innerText=n;const l=i("span")(`${t}`);return l.innerText=`${e}`,r.append(o,l),r}).fold(c),Ye=e=>pe(e,"current-score","Score"),Ge=()=>{const e=Number(window.localStorage.getItem("best-score"))??0;return pe(e,"best-score","Best")},fe=(e,t)=>u(i("header")("header")).map(n=>{const r=i("h1")("header-title");return r.innerText="2048",n.appendChild(r),n}).map(n=>{n.style.display="flex",n.style.justifyContent="space-between";const r=M(),o=O(t.length,r);return n.style.width=`${o*t.length}px`,n.style.alignItems="flex-start",n}).map(n=>{const r=i("div")("score-container");return r.append(Ye(e),Ge()),n.append(r),n}).fold(c),qe=e=>u(i("article")("button-bar")).map(t=>(t.style.display="flex",t)).map(t=>(t.append(...e),t)).fold(c),ge=({board:e,cells:t,base:n,colors:r,target:o})=>qe([Ue("bar restart-bar-btn"),me({board:e,cells:t,base:n,colors:r,className:"setting-bar",target:o}),ye({board:e,cells:t,base:n,colors:r,className:"setting-bar",target:o}),he({board:e,cells:t,base:n,colors:r,className:"setting-bar",target:o})]),Ke=({board:e,cells:t,base:n,colors:r,target:o})=>We(e)([d(_e({board:e,cells:t,btnLabel:"4x4",base:n,colors:r,target:o})),d(Qe({board:e,cells:t,btnLabel:"6x6",base:n,colors:r,target:o})),d(Je({board:e,cells:t,btnLabel:"8x8",base:n,colors:r,target:o})),d(me({board:e,cells:t,base:n,colors:r,className:"setting",target:o})),d(ye({board:e,cells:t,base:n,colors:r,className:"setting",target:o})),d(he({board:e,cells:t,base:n,colors:r,className:"setting",target:o}))]),Ue=e=>y("Restart",le,`restart-btn ${e}`),me=({base:e,board:t,colors:n,cells:r,className:o,target:l})=>{const s=n.map((a,g)=>Xe(n,a,g,e));return y("Colors",()=>{N({board:t,cells:globalThis.globalCells?K(globalThis.globalCells):r,state:globalThis.isPlaying&&globalThis.isPlaying.length>0?globalThis.isPlaying:"idle",visibility:"visible",base:globalThis.globalBase,colors:n,className:"color-plate",showOnClose:!0,target:l})([te([Ze(t,"board-color"),...s],"color-container")])},`${o??""} colors-btn`)},Xe=(e,t,n,r)=>{const o=i("p")("colors"),l=r!==2?Math.pow(2,n-1)*r:Math.pow(2,n),s=i("input")(`color-input--${l}`),a=i("label")("color-label");return a.innerText=`${n===0?"Empty Cell":l}`,s.setAttribute("type","color"),s.setAttribute("value",t),s.onchange=g=>{const L=g.target,{value:R}=L;e[n]=R},o.append(a,s),o},Ze=(e,t)=>{const n=i("p")("colors"),r=i("input")(`color-input--${t}`);r.setAttribute("type","color"),r.setAttribute("value","#bbada0"),r.onchange=l=>{const s=l.target,{value:a}=s;e.style.backgroundColor=a};const o=i("label")("color-label");return o.innerText="board",n.append(o,r),n},ye=({base:e,board:t,colors:n,cells:r,className:o,target:l})=>y("Rules",()=>{N({board:t,cells:globalThis.globalCells?K(globalThis.globalCells):r,state:globalThis.isPlaying&&globalThis.isPlaying.length>0?globalThis.isPlaying:"idle",visibility:"visible",base:e,colors:n,showOnClose:!0,target:l})([$])},`${o??""} rules-btn`),he=({board:e,cells:t,base:n,colors:r,className:o,target:l})=>y("Credits",()=>{N({board:e,cells:globalThis.globalCells?K(globalThis.globalCells):t,state:globalThis.isPlaying&&globalThis.isPlaying.length>0?globalThis.isPlaying:"idle",visibility:"visible",base:n,colors:r,showOnClose:!0,target:l})([h])},` ${o??""} credits-btn,`),$=i("p")("rules");$.style.padding="0";$.style.margin="0";$.style.paddingLeft="1em";$.style.marginTop="1em";$.innerHTML=`<strong>Press Keys</strong>    <br/><br/>
  Use Arrow keys, Vim keys or gaming keys  <br/><br/>
   &ensp;Left: "Arrow Left" or "a" or "j" <br/>
   &ensp;Right: "Arrow Right" "d" or "l"<br/>
   &ensp;Down: "Arrow Down" or "s" or "k"<br/>
   &ensp;up: "Arrow up" or "w" or "k"  <br/>
   <br/>

  &ensp;R: "To Restart the game" </br>
  </br>
  <strong>Rules</strong>
  <br/>
  If you reach 2048 in 4x4,
  <br/> 3072 in 6x6,
  <br/> 4096 in 8x8.
  <br/> You will win! &emsp;
  <strong>
  Good luck
  </strong>
`;const h=i("p")("rules");h.style.padding="0";h.style.padding="0";h.style.margin="0";h.style.paddingLeft="1em";h.style.marginTop="1em";h.innerHTML=`  
<br/>
<h2>2048</h2>
<br/><br/>
This <strong> 2048</strong> Sliding puzzle was published by  <br/>
 <a href="https://github.com/gabrielecirulli/2048"> source code by  Gabriele Cirulli</a>  <br/>
 <br/>
The font <a href="https://www.dafont.com/de/calculator.font">calculator</a> is used from Dafont.com <br/>
<br/>
Here is source Code from this <a href="https://github.com/rhnh/2048v2">repo</a>
`;const ee=({board:e,base:t,cells:n,btnLabel:r,colors:o,className:l,target:s})=>a=>y(r,()=>{globalThis.isPlaying="playing",m(e),n=J({cells:P(a),isInitial:!0,base:t,total:2}),z({board:e,cells:n,state:"playing",base:t,colors:o,target:s})},`play ${l}`),_e=({board:e,cells:t,btnLabel:n,base:r,colors:o,target:l})=>ee({board:e,cells:t,btnLabel:n,base:r,colors:o,className:"four",target:l})(4),Je=({board:e,cells:t,btnLabel:n,base:r,colors:o,target:l})=>ee({board:e,cells:t,btnLabel:n,base:r,colors:o,className:"eight",target:l})(8),Qe=({board:e,cells:t,btnLabel:n,base:r,colors:o,target:l})=>ee({board:e,cells:t,btnLabel:n,base:r,colors:o,className:"six",target:l})(6),de=(e,t)=>{const n=M(),r=O(t.length,n);return e.style.display="flex",e.style.height=`${r*t.length}px`,e.style.width=`${r*t.length}px`,e},te=(e,t)=>u(i("article")(t)).map(n=>n).map(n=>(n.append(...e),n)).fold(c),d=(e,t)=>u(i("div")(`wrapper ${t??""}`)).map(n=>(n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center",n.appendChild(e),n)).fold(c),We=e=>t=>u(i("article")("selection")).map(n=>(n.style.position="absolute",n.style.display="grid",n.style.gridTemplateColumns="repeat(2,1fr)",n.style.gridTemplateRows="repeat(3,1fr)",n.style.width="100%",n.style.height="100%",e.appendChild(n),n)).map(n=>(n.append(...t),n)).map(n=>(e.append(n),n)).fold(c),be=e=>u(i("section")("game-over--message")).map(t=>(t.innerHTML=e??"You lost",t)).fold(c),Y=({cells:e,board:t,base:n,colors:r,target:o})=>{e=J({cells:P(e.length),total:2,base:n,isInitial:!0}),z({cells:e,board:t,state:"playing",base:n,colors:r,target:o})},B=({base:e,board:t,cells:n,colors:r,target:o})=>N({board:t,cells:n,state:"playing",visibility:"visible",showOnClose:!1,base:e,colors:r,target:o})([de(te([be(`You lost! <br/> You are score <strong> ${globalThis.globalScore} </strong> `),y("Try again",()=>Y({board:t,cells:n,base:2,colors:r,target:o}),"status-btn try-again-btn")],"game-over"),n)]),oe=({board:e,cells:t,base:n,colors:r,target:o})=>N({board:e,cells:t,state:"playing",visibility:"visible",base:n,colors:r,showOnClose:!1,target:o})([de(te([be(""),y("Try again",()=>Y({board:e,cells:t,base:2,colors:r,target:o}),"status-btn try-again-btn"),u(i("button")("status-btn next-level-btn")).map(l=>(l.innerText="Keep playing",n===4&&(l.disabled=!0,l.style.display="none"),l)).map(l=>(l.onclick=()=>{globalThis.globalBase=n;const s=P(t.length);Y({board:e,cells:s,base:n,colors:r,target:o}),m(document.body),globalThis.globalCells=v(s),document.body.append(fe(0,t),e,ge({board:e,cells:t,colors:r,base:n,target:o}))},l)).fold(c)],"next-level"),t)]),et=({rgb:e,factor:t,colorConstant:n=.06899})=>({red:e.red*(1-n*t),green:e.green*(1-n*t),blue:e.blue*(1-n*t)}),tt=e=>e.startsWith("#")?e.slice(1):e,nt=e=>e.length===3?e.split("").map(t=>t+t).join(""):e,rt=e=>e.match(/.{2}/g),D=e=>parseInt(e,16),ot=e=>({red:D(e[0]),green:D(e[1]),blue:D(e[2])}),H=e=>Math.min(Math.max(Math.round(e),0),255).toString(16),F=e=>e.length===1?e+0:e,lt=e=>F(H(e.red))+F(H(e.green))+F(H(e.blue)),f=(e,t,n)=>u(e).map(tt).map(nt).map(rt).map(ot).map(r=>et({rgb:r,factor:t,colorConstant:n??.06899})).map(lt).map(r=>`#${r}`).fold(c),b=e=>e===0?0:Math.log(e)/Math.log(2),st=e=>b(e)%1===0;function it({cell:e,base:t,boardSize:n,colors:r}){return u(i("span")("cells")).map(o=>(o.innerText=e.value===0?"":`${e.value}`,o)).map(o=>(o.className+=` ${e.pValue===-1&&e.value===t||e.value===t*2&&e.pValue===-1?"new-cell":e.value===t*e.pValue&&e.pValue!==0?"double-cell":""}`,o)).map(o=>{const l=M(),s=Ie({actualScreenWidth:l,digitLength:`${e.value}`.length,boardSize:n});return o.style.fontSize=s,o}).map(o=>(r.map((l,s)=>{if(!st(e.value)){if(t%2!==0){const a=e.value/t;s===b(a)&&(o.style.backgroundColor=f(r[s+1],-1.4),o.style.color=f(l,17))}s===b(e.value)&&(o.style.backgroundColor=f(r[s],-1.4),o.style.color=f(l,17))}t===2&&s===b(e.value)||s===b(e.value)/t?(o.style.backgroundColor=f(r[s],-1.4),o.style.color=f(l,17)):s===b(e.value)&&(o.style.backgroundColor=f(r[s-1],-1.4),o.style.color=f(l,17))}),o)).fold(c)}const m=e=>{for(;e.firstChild;)e.firstChild.remove()},at=({boardSize:e})=>u(i("article")("board")).map(n=>{n.style.display="grid",n.style.position="relative";const r=M(),l=`${O(e,r)}px `.repeat(e);return n.style.gridTemplateColumns=l,n.style.gridTemplateRows=l,n.tabIndex=0,n.style.gap="1px",n}).map(n=>n).fold(c),ut=({cells:e,board:t,base:n,colors:r,target:o=2048})=>l=>{if(globalThis.globalCells=v(e),n>4){B({base:2,board:t,cells:e,colors:r,target:o});return}const s=Le(e);if(n===4&&s/n===o){B({base:2,board:t,cells:e,colors:r,target:o});return}if(n===2&&s===o){oe({board:t,cells:e,base:3,colors:r,target:o});return}if(n===3&&s/n===o){oe({board:t,cells:e,base:4,colors:r,target:o});return}if(j(e)){globalThis.globalCells=v(e),m(t),B({board:t,cells:e,base:n,colors:r,target:o}),ve();return}Number(globalThis.globalScore)>Number(localStorage.getItem("best-score"))&&localStorage.setItem("best-score",`${globalThis.globalScore}`);const a=l(e);if(ke(a,e))return V({board:t,cells:e,base:n,colors:r}),e;if(e=se({cells:a,base:n}),j(e)){globalThis.globalCells=v(e),m(t),B({board:t,cells:e,base:n,colors:r,target:o});return}return V({board:t,cells:e,base:n,colors:r}),e},V=({board:e,cells:t,base:n,colors:r})=>{globalThis.globalCells=v(t),ve(),Te(),m(e),t.flat().map(a=>e.append(it({cell:a,boardSize:t.length,base:n,colors:r}))),e.style.display="grid",e.style.position="relative";const o=M(),s=`${O(t.length,o)}px `.repeat(t.length);return e.style.gridTemplateColumns=s,e.style.gridTemplateRows=s,e.tabIndex=0,e.style.gap="1px",e};function z({cells:e,board:t,state:n,base:r,colors:o,target:l=2048}){if(j(e)&&n==="finished")return m(t),globalThis.globalCells=v(e),B({board:t,cells:e,base:r,colors:o,target:l}),globalThis.globalScore>Number(localStorage.getItem("best-score"))&&Te(),e;if(n==="playing"){const s=ut({cells:e,board:t,base:r,colors:o,target:l});return V({board:t,cells:e,base:r,colors:o}),Fe(s),je(t,s),e}return V({board:t,cells:e,base:r,colors:o}),Ke({board:t,cells:e,base:r,colors:o,target:l}),e}const ve=()=>{const e=document.querySelector(".current-score"),t=globalThis.globalScore;e.innerText=`${t}`},Te=()=>{const e=document.querySelector(".best-score"),t=localStorage.getItem("best-score");if(t&&Number(t)>globalThis.globalScore&&(e.innerText=`${t}`),(!t||t===null)&&(e.innerText="0"),t===null){e.innerText="0";return}e.innerText=`${t}`},E=2,xe=Math.pow(2,11),we=["#ccc0b3","#eee4da","#ede0c8","#f2b179","#f59563","#f67c5f","#f65e3b","#edcf72","#edcc61","#edc850","#ed2e2e","#8ecae6","#219ebc"];globalThis.globalScore=0;globalThis.globalBase=E;const G=at({boardSize:4}),q=J({cells:P(4),base:E,isInitial:!0,total:2});document.body.append(fe(0,q),G,ge({board:G,cells:q,colors:we,base:E,target:xe}));z({cells:q,board:G,state:"idle",base:E,colors:we,target:xe});
