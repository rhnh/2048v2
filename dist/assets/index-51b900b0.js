(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();const p=e=>e,c=e=>({map:t=>c(t(e)),fold:t=>t(e)}),le=()=>{Number(globalThis.globalScore)>Number(localStorage.getItem("best-score"))&&localStorage.setItem("best-score",`${globalThis.globalScore}`),window.location.reload()},P=()=>window.innerWidth>0?window.innerWidth:screen.width,x=e=>e.map(t=>t.map(n=>`${n.value}+${n.pValue}`)).toString(),Ce=e=>{let t=2;for(;t*t<e;)t++;return t},K=e=>{const t=e.split(","),n=[],r=t.map(o=>{const l=o.indexOf("+"),s=o.slice(0,l),i=o.slice(l+1);return{value:Number(s),pValue:Number(i),id:0}});for(;r.length;)n.push(r.splice(0,Ce(t.length)));return n},O=(e,t)=>{let n=150;return e===4&&(n=Se(t)),e===6&&(n=$e(t)),e===8&&(n=Be(t)),n};function Se(e){return e<=C?78:e<=S?88:e<=$?92:e<=B?94.5:e<=U?96:e<=X?101.5:e<=Z?105:(e<=_,120)}function $e(e){return e<=C?52:e<=S?60:e<=$?61:e<=B?62.5:e<=U?63.5:e<=X?67:e<=Z?70:e<=_?90:76}function Be(e){return e<=C?38.5:e<=S?43:e<=$?46:e<=B?46.5:e<=U?47.5:e<=X?50:e<=Z?52:(e<=_,70)}const C=320,S=360,$=375,B=384,U=390,X=414,Z=428,_=800,Ae=({digitLength:e,actualScreenWidth:t})=>t<=C?e<3?20:18:t<=S?e<3?30:20:t<=$||t<=B?e<3?35:22:40,Me=({digitLength:e,actualScreenWidth:t})=>t<=C||t<=S?e<3?24:20:t<=$?e<3?30:20:t<=B?e<3?35:22:24,Ne=({digitLength:e,actualScreenWidth:t})=>t<=C?e<3?24:20:t<=S?e<3?22:20:t<=$?e<3?25:22:t<=B?e<3?28:20:24;//!!Todo
function Pe({boardSize:e,actualScreenWidth:t,digitLength:n}){let r=40;return e===4&&(r=Ae({actualScreenWidth:t,digitLength:n})),e===6&&(r=Me({digitLength:n,actualScreenWidth:t})),e===8&&(r=Ne({digitLength:n,actualScreenWidth:t})),`${r}px`}const ne=e=>{const t=e.filter(r=>r.value!==0),n=e.filter(r=>r.value===0);return[...t,...n]},w=e=>Array.from(e),N=e=>{const t=w(e).map(n=>w(n));return t[0].map((n,r)=>t.map(o=>o[r]))},Ie=(e,t)=>{if(e.length!==t.length||!Array.isArray(e)||!Array.isArray(t))return!1;for(let n=0;n<e.length;n++)for(let r=0;r<e.length;r++)if(e[n][r].pValue!==t[n][r].pValue||e[n][r].value!==t[n][r].value||e[n][r].id!==t[n][r].id)return!1;return!0},ke=e=>[...Array.from(e)].map((t,n)=>{const r=e[n+1];return r===void 0?n:t.value===r.value?-1:n}).map(t=>t==-1).filter(t=>t===!0).length>0,Ee=e=>{const t=ne(w(e));for(let n=0;n<e.length;n++)t[n].pValue=0;for(let n=1;n<e.length;n++){let r=n-1;if(t[n].value===t[r].value){globalThis.globalScore+=t[n].value*2;let o={...t[n],pValue:0,value:0},l={...t[r],value:2*t[r].value,pValue:t[r].value};t[r]=l,t[n]=o}}return ne(w(t))},Ve=e=>e.flat().filter(t=>t.value===0).length<=0;function se({cells:e,isInitial:t=!1,base:n}){const r=w(e).map(i=>w(i));if(Ve(r))return r;const o=Oe(r),l=o[0],s=o[1];return r[l][s].pValue=-1,t?r[l][s].value=n:r[l][s].value=Math.random()<.9?n:2*n,r}const J=({cells:e,isInitial:t,base:n,total:r})=>{let o=0,l=[...e];for(;o<r;)l=se({cells:l,isInitial:t,base:n}),o++;return l},Oe=e=>{const t=e.map((r,o)=>r.map((l,s)=>l.value===0?[o,s]:[])).flat().filter(r=>r.length>0),n=Math.floor(Math.random()*t.length);return t[n]};function z(e){return Array.from(Array(e).keys()).map(()=>Array.from(Array(e).keys())).map(t=>t.map(()=>({value:0,id:0,pValue:0})))}const j=e=>He(e)&&!De(e)&&!ce(e);function ze(e,t){return t-e}const Le=e=>e.flat().map(t=>t.value).sort(ze)[0],Re=e=>e.slice().reverse(),re=e=>e.map(Re),ie=e=>e.map(Ee),Q=e=>c(e).map(ie).fold(p),W=e=>c(e).map(re).map(ie).map(re).fold(p),ae=e=>c(e).map(N).map(Q).map(N).fold(p),ue=e=>c(e).map(N).map(W).map(N).fold(p),ce=e=>Array.from(e).map(t=>ke(t)).filter(t=>t===!0).length!==0,De=e=>ce(N(Array.from(e))),He=e=>{var t;return((t=e.flat().find(n=>n.value===0))==null?void 0:t.value)!==0},E=(e,t)=>e.indexOf(t)!==-1,Fe=e=>{addEventListener("keydown",t=>{if(E(["ArrowDown","s","j"],t.key))return t.preventDefault(),e(ue);if(E(["ArrowUp","w","k"],t.key))return t.preventDefault(),e(ae);if(E(["ArrowLeft","a","h"],t.key))return t.preventDefault(),e(Q);if(E(["ArrowRight","d","l"],t.key))return t.preventDefault(),e(W);t.key==="r"&&le()})},je=(e,t)=>{const n={x1:0,y1:0,x2:0,y2:0};let r;const o=i=>{i.preventDefault(),globalThis.isPlaying==="pause"&&e.removeEventListener("touchstart",o,!1),n.x1=i.touches[0].clientX,n.y1=i.touches[0].clientY};e.addEventListener("touchstart",o,{passive:!1});const l=i=>{globalThis.isPlaying==="pause"&&e.removeEventListener("touchmove",l,!1),i.preventDefault(),n.x2=i.changedTouches[0].clientX,n.y2=i.changedTouches[0].clientY};e.addEventListener("touchmove",l,{passive:!1});const s=i=>{console.log(globalThis.isPlaying),globalThis.isPlaying==="pause"&&e.removeEventListener("touchend",s,!1),i.preventDefault();const g=n.x2-n.x1,d=n.y2-n.y1,b=Math.abs(d),u=Math.abs(g);Math.max(b,u)>50&&(r=u>b?g>0?"right":"left":d<0?"up":"down"),r==="down"&&t(ue),r==="up"&&t(ae),r==="left"&&t(Q),r==="right"&&t(W)};e.addEventListener("touchend",s)},y=(e,t,n)=>c(a("button")(n)).map(r=>(r.innerHTML=e,r)).map(r=>(r.onclick=t,r)).fold(p),a=e=>t=>c(document.createElement(e)).map(n=>(n.className+=t,n)).fold(p),I=({board:e,cells:t,state:n,visibility:r,onClose:o,className:l,colors:s,base:i,showOnClose:g=!0,target:d})=>b=>c(a("article")("modal")).map(u=>(u.className+=` ${l??""}`,u.style.zIndex="100000",u.style.position="absolute",u.style.width="100%",u.style.visibility=r,u)).map(u=>{if(!g)return u;const k=a("button")("modal-close");return k.innerText="x",u.appendChild(k),o&&(k.onclick=o),k.onclick=()=>{e.removeChild(u),m(e),Number(globalThis.globalScore)>Number(localStorage.getItem("best-score"))&&localStorage.setItem("best-score",`${globalThis.globalScore}`),L({cells:t,board:e,state:n,colors:s,base:i,target:d})},u}).map(u=>(u.append(...b),u)).map(u=>(m(e),e.append(u),u)).fold(p),pe=(e,t,n)=>c(a("section")("score")).map(r=>{const o=a("p")("score-label");o.innerText=n;const l=a("span")(`${t}`);return l.innerText=`${e}`,r.append(o,l),r}).fold(p),Ye=e=>pe(e,"current-score","Score"),Ge=()=>{const e=Number(window.localStorage.getItem("best-score"))??0;return pe(e,"best-score","Best")},fe=(e,t)=>c(a("header")("header")).map(n=>{const r=a("h1")("header-title");return r.innerText="2048",n.appendChild(r),n}).map(n=>{n.style.display="flex",n.style.justifyContent="space-between";const r=P(),o=O(t.length,r);return n.style.width=`${o*t.length}px`,n.style.alignItems="flex-start",n}).map(n=>{const r=a("div")("score-container");return r.append(Ye(e),Ge()),n.append(r),n}).fold(p),qe=e=>c(a("article")("button-bar")).map(t=>(t.style.display="flex",t)).map(t=>(t.append(...e),t)).fold(p),ge=({board:e,cells:t,base:n,colors:r,target:o})=>qe([Ue("bar restart-bar-btn"),me({board:e,cells:t,base:n,colors:r,className:"setting-bar",target:o}),ye({board:e,cells:t,base:n,colors:r,className:"setting-bar",target:o}),he({board:e,cells:t,base:n,colors:r,className:"setting-bar",target:o})]),Ke=({board:e,cells:t,base:n,colors:r,target:o})=>We(e)([v(_e({board:e,cells:t,btnLabel:"4x4",base:n,colors:r,target:o})),v(Qe({board:e,cells:t,btnLabel:"6x6",base:n,colors:r,target:o})),v(Je({board:e,cells:t,btnLabel:"8x8",base:n,colors:r,target:o})),v(me({board:e,cells:t,base:n,colors:r,className:"setting",target:o})),v(ye({board:e,cells:t,base:n,colors:r,className:"setting",target:o})),v(he({board:e,cells:t,base:n,colors:r,className:"setting",target:o}))]),Ue=e=>y("Restart",le,`restart-btn ${e}`),me=({base:e,board:t,colors:n,cells:r,className:o,target:l})=>{const s=n.map((i,g)=>Xe(n,i,g,e));return y("Colors",()=>{I({board:t,cells:globalThis.globalCells?K(globalThis.globalCells):r,state:globalThis.isPlaying&&globalThis.isPlaying.length>0?globalThis.isPlaying:"idle",visibility:"visible",base:globalThis.globalBase,colors:n,className:"color-plate",showOnClose:!0,target:l})([te([Ze(t,"board-color"),...s],"color-container")])},`${o??""} colors-btn`)},Xe=(e,t,n,r)=>{const o=a("p")("colors"),l=r!==2?Math.pow(2,n-1)*r:Math.pow(2,n),s=a("input")(`color-input--${l}`),i=a("label")("color-label");return i.innerText=`${n===0?"Empty Cell":l}`,s.setAttribute("type","color"),s.setAttribute("value",t),s.onchange=g=>{const d=g.target,{value:b}=d;e[n]=b},o.append(i,s),o},Ze=(e,t)=>{const n=a("p")("colors"),r=a("input")(`color-input--${t}`);r.setAttribute("type","color"),r.setAttribute("value","#bbada0"),r.onchange=l=>{const s=l.target,{value:i}=s;e.style.backgroundColor=i};const o=a("label")("color-label");return o.innerText="board",n.append(o,r),n},ye=({base:e,board:t,colors:n,cells:r,className:o,target:l})=>y("Rules",()=>{I({board:t,cells:globalThis.globalCells?K(globalThis.globalCells):r,state:globalThis.isPlaying&&globalThis.isPlaying.length>0?globalThis.isPlaying:"idle",visibility:"visible",base:e,colors:n,showOnClose:!0,target:l})([A])},`${o??""} rules-btn`),he=({board:e,cells:t,base:n,colors:r,className:o,target:l})=>y("Credits",()=>{I({board:e,cells:globalThis.globalCells?K(globalThis.globalCells):t,state:globalThis.isPlaying&&globalThis.isPlaying.length>0?globalThis.isPlaying:"idle",visibility:"visible",base:n,colors:r,showOnClose:!0,target:l})([h])},` ${o??""} credits-btn,`),A=a("p")("rules");A.style.padding="0";A.style.margin="0";A.style.paddingLeft="1em";A.style.marginTop="1em";A.innerHTML=`<strong>Press Keys</strong>    <br/><br/>
  Use Arrow keys, Vim keys or gaming keys  <br/><br/>
   &ensp;Left: "Arrow Left" or "a" or "j" <br/>
   &ensp;Right: "Arrow Right" "d" or "l"<br/>
   &ensp;Down: "Arrow Down" or "s" or "k"<br/>
   &ensp;up: "Arrow up" or "w" or "k"  <br/>
   <br/>

  &ensp;R: "To Restart the game" </br>
  </br>
  <strong>Rules</strong>
  <br/>
  If you reach 2048 in 4x4,
  <br/> 3072 in 6x6,
  <br/> 4096 in 8x8.
  <br/> You will win! &emsp;
  <strong>
  Good luck
  </strong>
`;const h=a("p")("rules");h.style.padding="0";h.style.padding="0";h.style.margin="0";h.style.paddingLeft="1em";h.style.marginTop="1em";h.innerHTML=`  
<br/>
<h2>2048</h2>
<br/><br/>
This <strong> 2048</strong> Sliding puzzle was published by  <br/>
 <a href="https://github.com/gabrielecirulli/2048"> source code by  Gabriele Cirulli</a>  <br/>
 <br/>
The font <a href="https://www.dafont.com/de/calculator.font">calculator</a> is used from Dafont.com <br/>
<br/>
Here is source Code from this <a href="https://github.com/rhnh/2048v2">repo</a>
`;const ee=({board:e,base:t,cells:n,btnLabel:r,colors:o,className:l,target:s})=>i=>y(r,()=>{globalThis.isPlaying="playing",m(e),n=J({cells:z(i),isInitial:!0,base:t,total:2}),L({board:e,cells:n,state:"playing",base:t,colors:o,target:s})},`play ${l}`),_e=({board:e,cells:t,btnLabel:n,base:r,colors:o,target:l})=>ee({board:e,cells:t,btnLabel:n,base:r,colors:o,className:"four",target:l})(4),Je=({board:e,cells:t,btnLabel:n,base:r,colors:o,target:l})=>ee({board:e,cells:t,btnLabel:n,base:r,colors:o,className:"eight",target:l})(8),Qe=({board:e,cells:t,btnLabel:n,base:r,colors:o,target:l})=>ee({board:e,cells:t,btnLabel:n,base:r,colors:o,className:"six",target:l})(6),de=(e,t)=>{const n=P(),r=O(t.length,n);return e.style.display="flex",e.style.height=`${r*t.length}px`,e.style.width=`${r*t.length}px`,e},te=(e,t)=>c(a("article")(t)).map(n=>n).map(n=>(n.append(...e),n)).fold(p),v=(e,t)=>c(a("div")(`wrapper ${t??""}`)).map(n=>(n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center",n.appendChild(e),n)).fold(p),We=e=>t=>c(a("article")("selection")).map(n=>(n.style.position="absolute",n.style.display="grid",n.style.gridTemplateColumns="repeat(2,1fr)",n.style.gridTemplateRows="repeat(3,1fr)",n.style.width="100%",n.style.height="100%",e.appendChild(n),n)).map(n=>(n.append(...t),n)).map(n=>(e.append(n),n)).fold(p),be=e=>c(a("section")("game-over--message")).map(t=>(t.innerHTML=e??"You lost",t)).fold(p),Y=({cells:e,board:t,base:n,colors:r,target:o})=>{e=J({cells:z(e.length),total:2,base:n,isInitial:!0}),L({cells:e,board:t,state:"playing",base:n,colors:r,target:o})},M=({base:e,board:t,cells:n,colors:r,target:o})=>I({board:t,cells:n,state:"playing",visibility:"visible",showOnClose:!1,base:e,colors:r,target:o})([de(te([be(`You lost! <br/> You are score <strong> ${globalThis.globalScore} </strong> `),y("Try again",()=>Y({board:t,cells:n,base:2,colors:r,target:o}),"status-btn try-again-btn")],"game-over"),n)]),oe=({board:e,cells:t,base:n,colors:r,target:o})=>I({board:e,cells:t,state:"playing",visibility:"visible",base:n,colors:r,showOnClose:!1,target:o})([de(te([be(""),y("Try again",()=>{globalThis.isPlaying="playing",Y({board:e,cells:t,base:2,colors:r,target:o})},"status-btn try-again-btn"),c(a("button")("status-btn next-level-btn")).map(l=>(l.innerText="Keep playing",n===4&&(l.disabled=!0,l.style.display="none"),l)).map(l=>(l.onclick=()=>{globalThis.globalBase=n,globalThis.isPlaying="playing";const s=z(t.length);Y({board:e,cells:s,base:n,colors:r,target:o}),m(document.body),globalThis.globalCells=x(s),document.body.append(fe(0,t),e,ge({board:e,cells:t,colors:r,base:n,target:o}))},l)).fold(p)],"next-level"),t)]),et=({rgb:e,factor:t,colorConstant:n=.06899})=>({red:e.red*(1-n*t),green:e.green*(1-n*t),blue:e.blue*(1-n*t)}),tt=e=>e.startsWith("#")?e.slice(1):e,nt=e=>e.length===3?e.split("").map(t=>t+t).join(""):e,rt=e=>e.match(/.{2}/g),D=e=>parseInt(e,16),ot=e=>({red:D(e[0]),green:D(e[1]),blue:D(e[2])}),H=e=>Math.min(Math.max(Math.round(e),0),255).toString(16),F=e=>e.length===1?e+0:e,lt=e=>F(H(e.red))+F(H(e.green))+F(H(e.blue)),f=(e,t,n)=>c(e).map(tt).map(nt).map(rt).map(ot).map(r=>et({rgb:r,factor:t,colorConstant:n??.06899})).map(lt).map(r=>`#${r}`).fold(p),T=e=>e===0?0:Math.log(e)/Math.log(2),st=e=>T(e)%1===0;function it({cell:e,base:t,boardSize:n,colors:r}){return c(a("span")("cells")).map(o=>(o.innerText=e.value===0?"":`${e.value}`,o)).map(o=>(o.className+=` ${e.pValue===-1&&e.value===t||e.value===t*2&&e.pValue===-1?"new-cell":e.value===t*e.pValue&&e.pValue!==0?"double-cell":""}`,o)).map(o=>{const l=P(),s=Pe({actualScreenWidth:l,digitLength:`${e.value}`.length,boardSize:n});return o.style.fontSize=s,o}).map(o=>(r.map((l,s)=>{if(!st(e.value)){if(t%2!==0){const i=e.value/t;s===T(i)&&(o.style.backgroundColor=f(r[s+1],-1.4),o.style.color=f(l,17))}s===T(e.value)&&(o.style.backgroundColor=f(r[s],-1.4),o.style.color=f(l,17))}t===2&&s===T(e.value)||s===T(e.value)/t?(o.style.backgroundColor=f(r[s],-1.4),o.style.color=f(l,17)):s===T(e.value)&&(o.style.backgroundColor=f(r[s-1],-1.4),o.style.color=f(l,17))}),o)).fold(p)}const m=e=>{for(;e.firstChild;)e.firstChild.remove()},at=({boardSize:e})=>c(a("article")("board")).map(n=>{n.style.display="grid",n.style.position="relative";const r=P(),l=`${O(e,r)}px `.repeat(e);return n.style.gridTemplateColumns=l,n.style.gridTemplateRows=l,n.tabIndex=0,n.style.gap="1px",n}).map(n=>n).fold(p),ut=({cells:e,board:t,base:n,colors:r,target:o=2048})=>l=>{if(globalThis.globalCells=x(e),n>4){M({base:2,board:t,cells:e,colors:r,target:o});return}const s=Le(e);if(n===4&&s/n===o){M({base:2,board:t,cells:e,colors:r,target:o});return}if(n===2&&s===o){globalThis.isPlaying="pause",oe({board:t,cells:e,base:3,colors:r,target:o});return}if(n===3&&s/n===o){globalThis.isPlaying="pause",oe({board:t,cells:e,base:4,colors:r,target:o});return}if(j(e)){globalThis.globalCells=x(e),m(t),M({board:t,cells:e,base:n,colors:r,target:o}),ve();return}Number(globalThis.globalScore)>Number(localStorage.getItem("best-score"))&&localStorage.setItem("best-score",`${globalThis.globalScore}`);const i=l(e);if(Ie(i,e))return V({board:t,cells:e,base:n,colors:r}),e;if(e=se({cells:i,base:n}),j(e)){globalThis.globalCells=x(e),m(t),M({board:t,cells:e,base:n,colors:r,target:o});return}return V({board:t,cells:e,base:n,colors:r}),e},V=({board:e,cells:t,base:n,colors:r})=>{globalThis.globalCells=x(t),ve(),Te(),m(e),t.flat().map(i=>e.append(it({cell:i,boardSize:t.length,base:n,colors:r}))),e.style.display="grid",e.style.position="relative";const o=P(),s=`${O(t.length,o)}px `.repeat(t.length);return e.style.gridTemplateColumns=s,e.style.gridTemplateRows=s,e.tabIndex=0,e.style.gap="1px",e};function L({cells:e,board:t,state:n,base:r,colors:o,target:l=2048}){if(j(e)&&n==="finished")return m(t),globalThis.globalCells=x(e),M({board:t,cells:e,base:r,colors:o,target:l}),globalThis.globalScore>Number(localStorage.getItem("best-score"))&&Te(),e;if(n==="playing"){const s=ut({cells:e,board:t,base:r,colors:o,target:l});return V({board:t,cells:e,base:r,colors:o}),Fe(s),je(t,s),e}return V({board:t,cells:e,base:r,colors:o}),Ke({board:t,cells:e,base:r,colors:o,target:l}),e}const ve=()=>{const e=document.querySelector(".current-score"),t=globalThis.globalScore;e.innerText=`${t}`},Te=()=>{const e=document.querySelector(".best-score"),t=localStorage.getItem("best-score");if(t&&Number(t)>globalThis.globalScore&&(e.innerText=`${t}`),(!t||t===null)&&(e.innerText="0"),t===null){e.innerText="0";return}e.innerText=`${t}`},R=2,xe=Math.pow(2,2),we=["#ccc0b3","#eee4da","#ede0c8","#f2b179","#f59563","#f67c5f","#f65e3b","#edcf72","#edcc61","#edc850","#ed2e2e","#8ecae6","#219ebc"];globalThis.globalScore=0;globalThis.globalBase=R;const G=at({boardSize:4}),q=J({cells:z(4),base:R,isInitial:!0,total:2});document.body.append(fe(0,q),G,ge({board:G,cells:q,colors:we,base:R,target:xe}));L({cells:q,board:G,state:"idle",base:R,colors:we,target:xe});
